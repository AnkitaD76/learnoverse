### API Testing File for REST Client (VS Code Extension)
### Install "REST Client" extension to use this file
### Variables
@baseUrl = http://localhost:3000/api/v1
@email = hrr3645@gmail.com
@password = admin123

#################################
### AUTHENTICATION ENDPOINTS ###
#################################

### 1. Register User (First user becomes admin)
POST {{baseUrl}}/auth/register
Content-Type: application/json

{
  "name": "Admin User",
  "email": "{{email}}",
  "password": "{{password}}"
}

### 2. Register Second User (Student)
POST {{baseUrl}}/auth/register
Content-Type: application/json

{
  "name": "Student User",
  "email": "student@example.com",
  "password": "student123"
}

### 3. Verify Email
# Replace verificationToken with actual token from email
POST {{baseUrl}}/auth/verify-email
Content-Type: application/json

{
  "email": "{{email}}",
  "verificationToken": "76662ed3b9928e765cc96af4c94fe0bf2b8a45691f2a49d3ca55416045e5179d35fdacdcf39c49f0"
}

### 4. Login
# @name login
POST {{baseUrl}}/auth/login
Content-Type: application/json

{
  "email": "{{email}}",
  "password": "{{password}}"
}

### 5. Get Current User
GET {{baseUrl}}/auth/me

### 6. Logout
POST {{baseUrl}}/auth/logout

### 7. Forgot Password
POST {{baseUrl}}/auth/forgot-password
Content-Type: application/json

{
  "email": "{{email}}"
}

### 8. Reset Password
# Replace token with actual token from email
POST {{baseUrl}}/auth/reset-password
Content-Type: application/json

{
  "email": "{{email}}",
  "token": "eee53afcb8c3f040cb9b2661b9dbed00f3e6267d9248d70446b1b1b4a422ff41c824dffcc68588a9",
  "password": "newPassword123"
}

### 9. Refresh Access Token
POST {{baseUrl}}/auth/refresh-token

#################################
### USER ENDPOINTS ###
#################################

### 10. Get Current User Profile
GET {{baseUrl}}/users/showMe

### 11. Update User Profile
PATCH {{baseUrl}}/users/updateUser
Content-Type: application/json

{
  "name": "Admin User Updated",
  "phone": "+1234567890",
  "country": "USA",
  "city": "New York",
  "bio": "Full-stack developer and educator",
  "interests": ["web development", "teaching", "coding"]
}

### 12. Update User Password
PATCH {{baseUrl}}/users/updateUserPassword
Content-Type: application/json

{
  "oldPassword": "{{password}}",
  "newPassword": "newPassword123"
}

### 13. Get Single User by ID
# Replace USER_ID with actual user ID
GET {{baseUrl}}/users/USER_ID

### 14. Get All Users (Admin Only)
GET {{baseUrl}}/users

### 15. Delete User Account
# Replace USER_ID with actual user ID
DELETE {{baseUrl}}/users/USER_ID

#################################
### ADMIN ENDPOINTS ###
#################################

### 16. Get User Statistics (Admin Only)
GET {{baseUrl}}/admin/stats

### 17. Get All Users with Filters (Admin Only)
GET {{baseUrl}}/admin/users?role=student&isVerified=true

### 18. Get All Users - Search (Admin Only)
GET {{baseUrl}}/admin/users?search=admin

### 19. Get All Unverified Users (Admin Only)
GET {{baseUrl}}/admin/users?isVerified=false

### 20. Get All Inactive Users (Admin Only)
GET {{baseUrl}}/admin/users?isActive=false

### 21. Get Single User by ID (Admin Only)
# Replace USER_ID with actual user ID
GET {{baseUrl}}/admin/users/USER_ID

### 22. Update User Role (Admin Only)
# Replace USER_ID with actual user ID
PATCH {{baseUrl}}/admin/users/USER_ID/role
Content-Type: application/json

{
  "role": "instructor"
}

### 23. Deactivate User Account (Admin Only)
# Replace USER_ID with actual user ID
PATCH {{baseUrl}}/admin/users/USER_ID/status
Content-Type: application/json

{
  "isActive": false
}

### 24. Activate User Account (Admin Only)
# Replace USER_ID with actual user ID
PATCH {{baseUrl}}/admin/users/USER_ID/status
Content-Type: application/json

{
  "isActive": true
}

### 25. Delete User (Admin Only)
# Replace USER_ID with actual user ID
DELETE {{baseUrl}}/admin/users/USER_ID

#################################
### TEST SCENARIOS ###
#################################

### Scenario 1: Complete Registration Flow
# 1. Register -> 2. Check email for token -> 3. Verify email -> 4. Login

### Scenario 2: Password Reset Flow
# 1. Forgot password -> 2. Check email for token -> 3. Reset password -> 4. Login with new password

### Scenario 3: Admin User Management
# 1. Login as admin -> 2. Get all users -> 3. Update user role -> 4. Deactivate user

### Scenario 4: User Profile Update
# 1. Login -> 2. Get profile -> 3. Update profile -> 4. Update password

#################################
### NOTES ###
#################################

# Cookie Management:
# REST Client automatically handles cookies between requests in the same file
# Make sure to login first before accessing protected routes

# Role-Based Access:
# - Admin: Full access to all endpoints
# - Instructor: Can manage courses (to be implemented)
# - Moderator: Can moderate content (to be implemented)
# - Student: Basic access

# Token Expiration:
# - Access Token: 15 minutes
# - Refresh Token: 7 days
# - Verification Token: 24 hours
# - Reset Token: 10 minutes

# Testing Tips:
# 1. Always register first user to get admin access
# 2. Keep this file open and use "Send Request" above each request
# 3. Replace placeholder values (USER_ID, tokens) with actual values
# 4. Check server console for detailed error messages
